---
title: WRITE UP WEB ASCIS 2023 WARMUP
date: 2023-10-07 17:34:01 +0700
categories: [CTF, ASCIS 2023, Write-Up]
tags: [web, write-up, ctf]     # TAG names should always be lowercase
---

## CHALLENG 1: HIDE AND SEEK!

### **Web Analysis:**

Táº¡i `/` trang web: 

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled.png)

KhÃ´ng cÃ³ báº¥t kÃ¬ thÃ´ng tin gÃ¬ vÃ  mÃ¬nh scan File&dir khÃ´ng cÃ³ phÃ¡t hiá»‡n gÃ¬ má»›i.

MÃ¬nh báº¯t Ä‘áº§u tÃ¬m Intrusted Data (báº¡n nÃ o chÆ°a biáº¿t untrusted data lÃ  gÃ¬ xem á»Ÿ Ä‘Ã¢y)
[á» Ä‘Ã¢y nÃ¨](https://youtu.be/DK8cUGsGZdc?si=8p_kjVAHxxFBy-4E)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%201.png)

VÃ  cÃ³ phÃ¡t hiá»‡n má»›i.

Giá» báº­t `HACK MODE` nÃ o.

### **Exploiting Host Header Injection:**

Sau khi 1 há»“i nghá»‹ch thÃªm xÃ³a sá»­a á»Ÿ pháº§n `Host: access.sectigo.one:18000` 

MÃ¬nh thá»­ xÃ³a bá»›t thÃ nh `Host: access.sectigo.on:18000`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%202.png)

NhÆ°ng nÃ³ chá»‰ cÃ³ 1 Ä‘oáº¡n cá»§a flag thÃ¬ mÃ¬nh Ä‘oÃ¡n ráº±ng trÃªn `Host` cÃ²n cÃ³ thá»ƒ thÃªm máº¥y máº£nh ghÃ©p ná»¯a.

nhÆ°ng mÃ¬nh send váº«n gÃ³i á»Ÿ trÃªn thÃ¬ nÃ³ láº¡i ra thÃªm 1 máº£nh ná»¯a.
edit 1 chá»• mÃ  ra táº­n 2 máº£nh quÃ¡ há»i =))

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%203.png)

Sau khi test nÃ¡t trÃªn url `access.sectigo.one`

thÃ¬ mÃ¬nh báº¯t Ä‘áº§u thá»­ bÃªn ip local Ä‘Æ°á»£c khÃ´ng. (bá»Ÿi má»—i trang web sáº½ cÃ³ kiá»ƒu IP public vÃ  IP local)

mÃ  public lÃ  cÃ¡i `access.sectigo.one` nÃ y nÃ¨.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%204.png)

NhÆ°ng cÅ©ng khÃ´ng ra gÃ¬ má»›i, mÃ¬nh tiáº¿n hÃ nh ngá»“i test thá»­ port xem. Bá»Ÿi Ã½ tÆ°á»Ÿng á»Ÿ trÃªn lÃ  thÃªm xÃ³a sá»­a mÃ  nÃªn mÃ¬nh cá»© flow nÃ y test cho háº¿t case xem sao.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%205.png)

VÃ  IP 18001 cÃ³ máº£nh ghÃ©p káº¿ tiáº¿p =)) nice sá»« 

MÃ¬nh test 2-6 nÃ³ ra trÃ¹ng máº¥y máº£nh á»Ÿ trÃªn cho tá»›i ip thá»© 7

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%206.png)

Náº¿u khÃ´ng ra mÃ¬nh Ä‘á»‹nh burte force tháº­t  may máº¯n quÃ¡.
Káº¿t há»£p láº¡i vÃ  ra FLAG : `ASCIS{0ppp!_Y0u-Rand0mly-F0und_M3_Gre@t!}` 

## CHALLENG 2: A BIG BLUE WHALE

### **Web Analysis:**

Táº¡i `/` trang web:

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%207.png)

KhÃ´ng cÃ³ gÃ¬ ngoÃ i con cÃ¡ voi mÃ  áº£nh nÃ y giá»‘ng cÃ¡i biá»ƒu tÆ°á»Ÿng bÃªn Docker =)) cÃ³ váº» nhÆ° liÃªn quan gÃ¬ Ä‘Ã³ rá»“i. 

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%208.png)

giá»‘ng nÃ¨ nÃ¨.
Trong nhÆ°ng trang web nÃ y khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t giá»‘ng Challenge bÃªn trÃªn vÃ  mÃ¬nh tiáº¿n hÃ nh recon nhÆ° bÃ¬nh thÆ°á»ng thÃ¬ phÃ¡t hiá»‡n trang web cÃ³ chá»©a Dockerfile.

Wordlist mÃ¬nh sá»­ dá»¥ng [á»Ÿ Ä‘Ã¢y nÃ¨](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/fuzz-Bo0oM.txt) .

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%209.png)

MÃ¬nh thá»­ truy cáº­p [https://bluewhale.sectigo.one/Dockerfile](https://bluewhale.sectigo.one/)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2010.png)

ThÃ¬ nÃ³ downloads vá» vÃ  mÃ¬nh open

```docker
FROM sectigo1/webbase:latest
LABEL MAINTAINER Sectigo <system@sectigo.one>
USER root
RUN mkdir -p /etc/nginx/ssl
COPY ssl/server* /etc/nginx/ssl/
COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY ./index.html ./Dockerfile /usr/share/nginx/html
EXPOSE 80 443
HEALTHCHECK CMD curl --fail -k https://localhost:443 || exit 1
CMD ["nginx", "-g", "daemon off;"]
USER nginx
```

á» Ä‘Ã¢y nÃ³ dá»±ng 1 docker Ä‘Æ°á»£c build lÃªn tá»« image lÃ  `sectigo1/webbase:latest`

dÆ°á»›i quyá»n `root` thÃ¬ mÃ¬nh cÃ³ idea lÃ   mÃ¬nh sáº½ exec vÃ o docker image dÆ°á»›i quyá»n `root` Ä‘á»ƒ láº¥y flag. 

`*TrÆ°á»›c mÃ¬nh cÃ³ tá»± há»c qua vá» pentest docker nÃªn cÅ©ng cÃ³ chÃºt kiáº¿n thá»©c.*`

CÃ¹ng kiá»ƒm chá»©ng Ã½ tÆ°á»Ÿng nhÃ©. 

### **Exploiting Dockerfile :**

TrÆ°á»›c tiÃªn mÃ¬nh pull image cá»§a docker vá»: 

(vÃ¬ mÃ¬nh cÃ³ name cá»§a image nÃªn mÃ¬nh Ä‘Æ°á»£c quyá»n pull nhÃ©).

MÃ¬nh Ä‘Ã£ lÃ m rá»“i nÃªn lÃºc pull Ä‘á»£i nÃ³ downloads nha.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2011.png)

Sau Ä‘Ã³ sá»­ dá»¥ng `docker images` Ä‘á»ƒ liá»‡t kÃª táº¥t cáº£ image trong docker:

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2012.png)

MÃ¬nh dÃ¹ng IMAGE ID

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2013.png)

mÃ¬nh thá»­ build lÃªn nhÆ°ng khÃ´ng Ä‘Æ°á»£c. 

VÃ¬ `CMD ["nginx", "-g", "daemon off;"]` trong dockerfile nÃ³ táº¯t docker deamon nÃªn mÃ¬nh khÃ´ng exec vÃ o docker muá»‘n vÃ o docker thÃ¬ pháº£i login nhÆ°ng pháº£i cÃ³ passwd.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2014.png)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2015.png)

ThÃ¬ á»Ÿ trong docker image nÃ³ cÃ³ 1 cmd lÃ  save ( nÃ³ cho save hÃ¬nh áº£nh vá» output vá»›i dáº¡ng vÄƒn báº£n, sáº½ hiá»ƒn thá»‹ táº¥t cáº£ ná»™i dung trong image chá»©a gÃ¬) kiáº¿n thá»©c nÃ y mÃ¬nh Ä‘Æ°á»£c tá»± há»c docker security nÃªn cháº¯c cÅ©ng khÃ¡ má»›i vá»›i cÃ¡c báº¡n cÃ³ gÃ¬ tÃ¬m hiá»ƒu sá»­ dá»¥ng docker nhÃ©).

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2016.png)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2017.png)

CMD: `docker image save 7b1425204c8d -o flag`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2018.png)

Äá»«ng sá»­ dá»¥ng cat nha. gáº§n 1 triá»‡u dÃ²ng nÃ³ bug luÃ´n cÃ¡i terminal Ã¡.

Open file báº±ng VSCODE

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2019.png)

vÃ¬ quÃ¡ nhiá»u nÃªn mÃ¬nh Ä‘Ã£ search tá»« khÃ³a cá»§a Flag lÃ  `ASCIS{`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2020.png)

FLAG cuá»‘i: `ASCIS{1t_R3a114_30rks_0n_m4_m@chin3}` 

Done =))

MÃ¬nh xÃ©t tá»‘t nghiá»‡p rá»“i trÆ°á»ng khÃ´ng cho thi ná»¯a ğŸ™‚ nÃªn cÅ©ng nghá»‹ch lÃ m thá»­

Cáº£m Æ¡n cÃ¡c báº¡n Ä‘Ã£ xem write up cá»§a mÃ¬nh

Náº¿u tháº¥y há»¯u Ã­ch hoáº·c tháº¯c máº¯c gÃ¬ thÃ¬ liÃªn há»‡ mÃ¬nh gÃ³p Ã½ nhÃ© 
ID DISCORD: `ren6806`