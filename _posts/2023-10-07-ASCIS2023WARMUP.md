---
title: WRITE UP WEB ASCIS 2023 WARMUP
date: 2023-10-07 17:34:01 +0700
categories: [CTF, ASCIS 2023, Write-Up]
tags: [web, write-up, ctf]     # TAG names should always be lowercase
---

## CHALLENG 1: HIDE AND SEEK!

### **Web Analysis:**

T·∫°i `/` trang web: 

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled.png)

Kh√¥ng c√≥ b·∫•t k√¨ th√¥ng tin g√¨ v√† m√¨nh scan File&dir kh√¥ng c√≥ ph√°t hi·ªán g√¨ m·ªõi.

M√¨nh b·∫Øt ƒë·∫ßu t√¨m Intrusted Data (b·∫°n n√†o ch∆∞a bi·∫øt untrusted data l√† g√¨ xem ·ªü ƒë√¢y)
[·ªû ƒë√¢y n√®](https://youtu.be/DK8cUGsGZdc?si=8p_kjVAHxxFBy-4E)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%201.png)

V√† c√≥ ph√°t hi·ªán m·ªõi.

Gi·ªù b·∫≠t `HACK MODE` n√†o.

### **Exploiting Host Header Injection:**

Sau khi 1 h·ªìi ngh·ªãch th√™m x√≥a s·ª≠a ·ªü ph·∫ßn `Host: access.sectigo.one:18000` 

M√¨nh th·ª≠ x√≥a b·ªõt th√†nh `Host: access.sectigo.on:18000`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%202.png)

Nh∆∞ng n√≥ ch·ªâ c√≥ 1 ƒëo·∫°n c·ªßa flag th√¨ m√¨nh ƒëo√°n r·∫±ng tr√™n `Host` c√≤n c√≥ th·ªÉ th√™m m·∫•y m·∫£nh gh√©p n·ªØa.

nh∆∞ng m√¨nh send v·∫´n g√≥i ·ªü tr√™n th√¨ n√≥ l·∫°i ra th√™m 1 m·∫£nh n·ªØa.
edit 1 ch·ªï m√† ra t·∫≠n 2 m·∫£nh qu√° h·ªùi =))

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%203.png)

Sau khi test n√°t tr√™n url `access.sectigo.one`

th√¨ m√¨nh b·∫Øt ƒë·∫ßu th·ª≠ b√™n ip local ƒë∆∞·ª£c kh√¥ng. (b·ªüi m·ªói trang web s·∫Ω c√≥ ki·ªÉu IP public v√† IP local)

m√† public l√† c√°i `access.sectigo.one` n√†y n√®.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%204.png)

Nh∆∞ng c≈©ng kh√¥ng ra g√¨ m·ªõi, m√¨nh ti·∫øn h√†nh ng·ªìi test th·ª≠ port xem. B·ªüi √Ω t∆∞·ªüng ·ªü tr√™n l√† th√™m x√≥a s·ª≠a m√† n√™n m√¨nh c·ª© flow n√†y test cho h·∫øt case xem sao.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%205.png)

V√† IP 18001 c√≥ m·∫£nh gh√©p k·∫ø ti·∫øp =)) nice s·ª´ 

M√¨nh test 2-6 n√≥ ra tr√πng m·∫•y m·∫£nh ·ªü tr√™n cho t·ªõi ip th·ª© 7

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%206.png)

N·∫øu kh√¥ng ra m√¨nh ƒë·ªãnh burte force th·∫≠t  may m·∫Øn qu√°.
K·∫øt h·ª£p l·∫°i v√† ra FLAG : `ASCIS{0ppp!_Y0u-Rand0mly-F0und_M3_Gre@t!}` 

## CHALLENG 2: A BIG BLUE WHALE

### **Web Analysis:**

T·∫°i `/` trang web:

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%207.png)

Kh√¥ng c√≥ g√¨ ngo√†i con c√° voi m√† ·∫£nh n√†y gi·ªëng c√°i bi·ªÉu t∆∞·ªüng b√™n Docker =)) c√≥ v·∫ª nh∆∞ li√™n quan g√¨ ƒë√≥ r·ªìi. 

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%208.png)

gi·ªëng n√® n√®.
Trong nh∆∞ng trang web n√†y kh√¥ng c√≥ g√¨ ƒë·∫∑c bi·ªát gi·ªëng Challenge b√™n tr√™n v√† m√¨nh ti·∫øn h√†nh recon nh∆∞ b√¨nh th∆∞·ªùng th√¨ ph√°t hi·ªán trang web c√≥ ch·ª©a Dockerfile.

Wordlist m√¨nh s·ª≠ d·ª•ng [·ªü ƒë√¢y n√®](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/fuzz-Bo0oM.txt) .

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%209.png)

M√¨nh th·ª≠ truy c·∫≠p [https://bluewhale.sectigo.one/Dockerfile](https://bluewhale.sectigo.one/)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2010.png)

Th√¨ n√≥ downloads v·ªÅ v√† m√¨nh open

```docker
FROM sectigo1/webbase:latest
LABEL MAINTAINER Sectigo <system@sectigo.one>
USER root
RUN mkdir -p /etc/nginx/ssl
COPY ssl/server* /etc/nginx/ssl/
COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY ./index.html ./Dockerfile /usr/share/nginx/html
EXPOSE 80 443
HEALTHCHECK CMD curl --fail -k https://localhost:443 || exit 1
CMD ["nginx", "-g", "daemon off;"]
USER nginx
```

·ªû ƒë√¢y n√≥ d·ª±ng 1 docker ƒë∆∞·ª£c build l√™n t·ª´ image l√† `sectigo1/webbase:latest`

d∆∞·ªõi quy·ªÅn `root` th√¨ m√¨nh c√≥ idea l√†  m√¨nh s·∫Ω exec v√†o docker image d∆∞·ªõi quy·ªÅn `root` ƒë·ªÉ l·∫•y flag. 

`*Tr∆∞·ªõc m√¨nh c√≥ t·ª± h·ªçc qua v·ªÅ pentest docker n√™n c≈©ng c√≥ ch√∫t ki·∫øn th·ª©c.*`

C√πng ki·ªÉm ch·ª©ng √Ω t∆∞·ªüng nh√©. 

### **Exploiting Dockerfile :**

C√ÅCH 1: DUMP IMAGE DOCKER

Tr∆∞·ªõc ti√™n m√¨nh pull image c·ªßa docker v·ªÅ: 

(v√¨ m√¨nh c√≥ name c·ªßa image n√™n m√¨nh ƒë∆∞·ª£c quy·ªÅn pull nh√©).

M√¨nh ƒë√£ l√†m r·ªìi n√™n l√∫c pull ƒë·ª£i n√≥ downloads nha.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2011.png)

Sau ƒë√≥ s·ª≠ d·ª•ng `docker images` ƒë·ªÉ li·ªát k√™ t·∫•t c·∫£ image trong docker:

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2012.png)

M√¨nh d√πng IMAGE ID

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2013.png)

m√¨nh th·ª≠ build l√™n nh∆∞ng kh√¥ng ƒë∆∞·ª£c. 

V√¨ `CMD ["nginx", "-g", "daemon off;"]` trong dockerfile n√≥ t·∫Øt docker deamon n√™n m√¨nh kh√¥ng exec v√†o docker mu·ªën v√†o docker th√¨ ph·∫£i login nh∆∞ng ph·∫£i c√≥ passwd.

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2014.png)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2015.png)

Th√¨ ·ªü trong docker image n√≥ c√≥ 1 cmd l√† save .

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2016.png)

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2017.png)

CMD: `docker image save 7b1425204c8d -o flag`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2018.png)

ƒê·ª´ng s·ª≠ d·ª•ng cat nha. g·∫ßn 1 tri·ªáu d√≤ng n√≥ bug lu√¥n c√°i terminal √°.

Open file b·∫±ng VSCODE

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2019.png)

v√¨ qu√° nhi·ªÅu n√™n m√¨nh ƒë√£ search t·ª´ kh√≥a c·ªßa Flag l√† `ASCIS{`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2020.png)

FLAG cu·ªëi: `ASCIS{1t_R3a114_30rks_0n_m4_m@chin3}` 

C√ÅCH 2: EXEC IMAGE DOCKER

CMD: `sudo docker run --user root sectigo1/webbase`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2021.jpg)

CMD: `docker ps`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2022.jpg)

CMD: `docker exec -it 00fc334ca47b /bin/sh`

![Untitled](/assets/writeup/ascis_2023/Web_warmup/Untitled%2023.jpg)

Done =))

M√¨nh x√©t t·ªët nghi·ªáp r·ªìi tr∆∞·ªùng kh√¥ng cho thi n·ªØa üôÇ n√™n c≈©ng ngh·ªãch l√†m th·ª≠

C·∫£m ∆°n c√°c b·∫°n ƒë√£ xem write up c·ªßa m√¨nh

N·∫øu th·∫•y h·ªØu √≠ch ho·∫∑c th·∫Øc m·∫Øc g√¨ th√¨ li√™n h·ªá m√¨nh g√≥p √Ω nh√© 
ID DISCORD: `ren6806`